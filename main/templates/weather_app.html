{% extends "base.html" %}

{% block title %}Weather App â€” Elvin's CodeBase{% endblock %}

{% block content %}

<style>
  .hero {
    background: linear-gradient(135deg,#eaf2ff,#f6fff4);
    border-radius: 1rem;
    padding: 1.25rem 1rem;
    margin-bottom: 1.25rem;
  }
  .gradient-text{
    background-image: linear-gradient(135deg,#0d6efd,#22c55e);
    background-size: 100%; background-repeat: repeat;
    color: transparent; -webkit-background-clip: text; background-clip: text;
  }
  .wx-card { border-radius: 1rem; }
  .wx-badge { background:#eef2ff; border-radius:999px; padding:.15rem .6rem; font-size:.8rem }
  .day-card {
    border: 1px solid rgba(0,0,0,.06);
    border-radius: .9rem;
    padding: .9rem;
    background: #fff;
    box-shadow: 0 6px 18px rgba(0,0,0,.06);
    height: 100%;
  }
  .day-name { font-weight: 600; }
  .temp-max { font-weight:700; }
  .temp-min { color:#6c757d; }
  .mini { font-size: .92rem; color:#6c757d; }
</style>

<div class="container">

  <!-- Header -->
  <div class="hero shadow-sm">
    <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
      <div>
        <div class="text-uppercase text-muted" style="letter-spacing:.08em;font-size:.8rem;">Projects / Weather</div>
        <h1 class="h3 mb-1"><span class="gradient-text">Weather App</span></h1>
        <p class="text-muted mb-0">Enter a city and get the current conditions plus a 5-day forecast (3-hour intervals, aggregated per day).</p>
      </div>
      <div class="text-end">
        <span class="wx-badge">OpenWeather (free)</span>
        <span class="wx-badge ms-1">Metric (Â°C)</span>
      </div>
    </div>
  </div>

  <!-- Form -->
  <div class="card shadow-sm wx-card mb-3">
    <div class="card-body">
      <form method="get" class="row g-2 align-items-end">
        <div class="col-md-8">
          <label class="form-label mb-1">City name</label>
          <input
            type="text"
            name="city"
            class="form-control"
            placeholder="e.g. Baku, Warsaw, London"
            value="{{ city }}"
          >
        </div>
        <div class="col-md-4">
          <label class="form-label mb-1 d-none d-md-block">&nbsp;</label>
          <button class="btn btn-primary w-100" type="submit">ğŸ” Check Weather</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Errors -->
  {% if error %}
    <div class="alert alert-danger shadow-sm">{{ error }}</div>
  {% endif %}

  <!-- Current Weather -->
  {% if current %}
    <div class="card shadow-sm wx-card mb-3">
      <div class="card-body">
        <div class="d-flex align-items-center">
          {% if current.icon_url %}
            <img src="{{ current.icon_url }}" alt="{{ current.description }}" width="64" height="64" class="me-3">
          {% else %}
            <div class="me-3" style="font-size:2rem;">ğŸŒ¤</div>
          {% endif %}
          <div>
            <h5 class="fw-semibold mb-1">
              {{ current.city }}{% if current.country %}, {{ current.country }}{% endif %}
            </h5>
            <div class="fs-5"><strong>{{ current.temp }}Â°C</strong> â€¢ {{ current.description }}</div>
            <div class="mini mt-1 d-flex flex-wrap gap-3">
              <span>Feels like {{ current.feels_like }}Â°C</span>
              <span>Humidity {{ current.humidity }}%</span>
              <span>Wind {{ current.wind_speed }} m/s</span>
              {% if current.sunrise and current.sunset %}
                <span>Sunrise {{ current.sunrise }}</span>
                <span>Sunset {{ current.sunset }}</span>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endif %}

  <!-- 5-Day Forecast (aggregated from 3h intervals) -->
  {% if daily and daily|length > 0 %}
    <h6 class="text-muted mb-2">5-Day forecast</h6>
    <div class="row g-3">
      {% for d in daily %}
        <div class="col-6 col-sm-4 col-lg-3">
          <div class="day-card">
            <div class="d-flex align-items-center justify-content-between">
              <div class="day-name">{{ d.weekday }}</div>
              <div class="mini">{{ d.date }}</div>
            </div>
            <div class="text-center my-2">
              {% if d.icon_url %}
                <img src="{{ d.icon_url }}" alt="{{ d.description }}" width="64" height="64">
              {% endif %}
            </div>
            <div class="text-center">
              <div class="temp-max">{{ d.temp_max }}Â°</div>
              <div class="temp-min">min {{ d.temp_min }}Â°</div>
            </div>
            <div class="mini mt-2 text-center" style="min-height:2.2em;">{{ d.description }}</div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {% if not current and not error %}
    <p class="text-muted text-center mt-4">
      Type a city above and click <strong>Check Weather</strong>.
    </p>
  {% endif %}
</div>

{% endblock %}
